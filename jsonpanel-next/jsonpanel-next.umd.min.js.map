{"version":3,"file":"jsonpanel-next.umd.min.js","sources":["../src/util.js","../src/pair.js","../src/panel.js","../node_modules/style-inject/dist/style-inject.es.js","../src/main.js"],"sourcesContent":["function isPlainObject(obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n}\n\nfunction objectHasProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nfunction simpleClone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction getObjectWithDefaults(obj, defaultObj) {\n  const newObj = simpleClone(defaultObj);\n  return Object.assign(newObj, obj);\n}\n\nfunction prettyPrintObj(obj, spaces = 2) {\n  return JSON.stringify(obj, null, spaces);\n}\n\nexport {\n  isPlainObject,\n  objectHasProperty,\n  getObjectWithDefaults,\n  prettyPrintObj\n};\n","import {isPlainObject} from './util';\nimport Panel from './panel';\n\nclass Pair {\n  constructor(key, val, valTransformer) {\n    this.key = key;\n    this.val = val;\n    this.valTransformer = valTransformer;\n  }\n\n  static create(key, val, valTransformer) {\n    if (isPlainObject(val) || Array.isArray(val)) {\n      return new ExpandablePair(key, val, valTransformer);\n    }\n\n    return new SimplePair(key, val, valTransformer);\n  }\n\n  getKeyMarkup() {\n    return `<span class=\"key\">${this.key}</span>`;\n  }\n\n  get valType() {\n    return typeof this.val;\n  }\n\n  getValInnerMarkup() {\n    return JSON.stringify(this.val);\n  }\n\n  createTagInnerMarkup() {\n    return `${this.getKeyMarkup()}: <span class=\"val ${\n      this.valType\n    }\">${this.getValInnerMarkup()}</span>`;\n  }\n\n  get class() {\n    return 'pair';\n  }\n\n  createTag() {\n    const li = document.createElement('li');\n    li.className = this.class;\n    li.innerHTML = this.createTagInnerMarkup();\n    return li;\n  }\n\n  render() {\n    this.el = this.createTag();\n  }\n}\n\nclass SimplePair extends Pair {\n  get class() {\n    return `${super.class} simple`;\n  }\n\n  getValInnerMarkup() {\n    if (this.valTransformer instanceof Function) {\n      return this.valTransformer(super.getValInnerMarkup());\n    }\n\n    return super.getValInnerMarkup();\n  }\n}\n\nclass ExpandablePair extends Pair {\n  get valType() {\n    return Array.isArray(this.val) ? 'array' : 'object';\n  }\n\n  get class() {\n    return `${super.class} expandable`;\n  }\n\n  getValInnerMarkup() {\n    const valStr = super.getValInnerMarkup();\n    // Truncate the array / object preview using val-inner class.\n    // eg. { key: \"val\" } -> {<span class=\"val-inner\">key: \"val\"</span>}\n    const valMatch = valStr.match(/^([{[])(.*)([}\\]])$/);\n    return `${valMatch[1]}<span class=\"val-inner\">${valMatch[2]}</span>${valMatch[3]}`;\n  }\n\n  createTagInnerMarkup() {\n    return `<a class=\"expander\" href=\"#\">${super.createTagInnerMarkup()}</a>`;\n  }\n\n  render() {\n    super.render();\n    this.el\n      .querySelector('.expander')\n      .addEventListener('click', evt => this.onKeyClick(evt));\n  }\n\n  get expanded() {\n    return this.el.classList.contains('expanded');\n  }\n\n  expand() {\n    // Open new panel\n    Panel.renderToEl(this.el, {\n      data: this.val,\n      valTransformer: this.valTransformer\n    });\n    this.el.classList.add('expanded');\n  }\n\n  collapse() {\n    this.el.querySelectorAll('.panel').forEach(e => e.remove());\n    this.el.classList.remove('expanded');\n  }\n\n  onKeyClick(evt) {\n    if (this.expanded) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n\n    evt.stopPropagation();\n    evt.preventDefault();\n  }\n}\n\nexport default Pair.create;\n","import createPair from './pair';\n\nexport default class Panel {\n  constructor(options) {\n    this.options = options;\n  }\n\n  get selector() {\n    return this.options.selector;\n  }\n\n  get data() {\n    return this.options.data;\n  }\n\n  get valTransformer() {\n    return this.options.valTransformer;\n  }\n\n  isArray() {\n    return Array.isArray(this.data);\n  }\n\n  createListTag() {\n    if (this.isArray()) {\n      const ol = document.createElement('ol');\n      ol.className = 'list';\n      ol.start = 0;\n      return ol;\n    }\n\n    const ul = document.createElement('ul');\n    ul.className = 'list';\n    return ul;\n  }\n\n  createListItem(key, val) {\n    const pair = createPair(key, val, this.valTransformer);\n    pair.render();\n    return pair.el;\n  }\n\n  render() {\n    const list = this.createListTag();\n    Object.entries(this.data).forEach(([key, val]) => {\n      list.append(this.createListItem(key, val));\n    });\n\n    const listWrap = document.createElement('div');\n    listWrap.className = 'panel';\n    listWrap.append(list);\n    this.el = listWrap;\n    return this;\n  }\n\n  static renderToEl(container, options) {\n    const panel = new Panel(options);\n    panel.render();\n\n    container.append(panel.el);\n    return panel;\n  }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import Panel from './panel';\nimport {getObjectWithDefaults} from './util';\nimport './styles/jsonpanel-next.scss';\n\nconst defaultOptions = {\n  selector: '#jsonpanel',\n  data: {}\n};\n\nexport default function jsonpanelNext(options) {\n  options = getObjectWithDefaults(options, defaultOptions);\n  return Panel.renderToEl(\n    window.document.querySelector(options.selector),\n    options\n  );\n}\n"],"names":["getObjectWithDefaults","obj","defaultObj","const","newObj","JSON","parse","stringify","simpleClone","Object","assign","Pair","key","val","valTransformer","this","create","prototype","toString","call","isPlainObject","Array","isArray","ExpandablePair","SimplePair","getKeyMarkup","prototypeAccessors","valType","getValInnerMarkup","createTagInnerMarkup","class","createTag","li","document","createElement","className","innerHTML","render","el","prototypeAccessors$1","super","Function","prototypeAccessors$2","valMatch","match","querySelector","addEventListener","evt","onKeyClick","expanded","classList","contains","expand","Panel","renderToEl","data","add","collapse","querySelectorAll","forEach","e","remove","stopPropagation","preventDefault","options","selector","createListTag","ol","start","ul","createListItem","pair","createPair","list","entries","append","listWrap","container","panel","css","ref","insertAt","head","getElementsByTagName","style","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","defaultOptions","window"],"mappings":"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"}