{"version":3,"file":"jsonpanel-next.umd.min.js","sources":["../src/util.js","../src/pair.js","../src/panel.js","../node_modules/style-inject/dist/style-inject.es.js","../src/main.js"],"sourcesContent":["function isPlainObject(obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n}\n\nfunction objectHasProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nfunction simpleClone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction getObjectWithDefaults(obj, defaultObj) {\n  const newObj = simpleClone(defaultObj);\n  return Object.assign(newObj, obj);\n}\n\nfunction prettyPrintObj(obj, spaces = 2) {\n  return JSON.stringify(obj, null, spaces);\n}\n\nexport {\n  isPlainObject,\n  objectHasProperty,\n  getObjectWithDefaults,\n  prettyPrintObj\n};\n","import {isPlainObject} from './util';\nimport Panel from './panel';\n\nclass Pair {\n  constructor(key, val, valTransformer) {\n    this.key = key;\n    this.val = val;\n    this.valTransformer = valTransformer;\n  }\n\n  static create(key, val, valTransformer) {\n    if (isPlainObject(val) || Array.isArray(val)) {\n      return new ExpandablePair(key, val, valTransformer);\n    }\n\n    return new SimplePair(key, val, valTransformer);\n  }\n\n  getKeyMarkup() {\n    return `<span class=\"key\">${this.key}</span>`;\n  }\n\n  get valType() {\n    return typeof this.val;\n  }\n\n  getValInnerMarkup() {\n    return JSON.stringify(this.val);\n  }\n\n  createTagInnerMarkup() {\n    return `${this.getKeyMarkup()}: <span class=\"val ${\n      this.valType\n    }\">${this.getValInnerMarkup()}</span>`;\n  }\n\n  get class() {\n    return 'pair';\n  }\n\n  createTag() {\n    const li = document.createElement('li');\n    li.className = this.class;\n    li.innerHTML = this.createTagInnerMarkup();\n    return li;\n  }\n\n  render() {\n    this.el = this.createTag();\n  }\n}\n\nclass SimplePair extends Pair {\n  get class() {\n    return `${super.class} simple`;\n  }\n\n  getValInnerMarkup() {\n    if (this.valTransformer instanceof Function) {\n      return this.valTransformer(super.getValInnerMarkup());\n    }\n\n    return super.getValInnerMarkup();\n  }\n}\n\nclass ExpandablePair extends Pair {\n  get valType() {\n    return Array.isArray(this.val) ? 'array' : 'object';\n  }\n\n  get class() {\n    return `${super.class} expandable`;\n  }\n\n  getValInnerMarkup() {\n    const valStr = super.getValInnerMarkup();\n    // Truncate the array / object preview using val-inner class.\n    // eg. { key: \"val\" } -> {<span class=\"val-inner\">key: \"val\"</span>}\n    const valMatch = valStr.match(/^([{[])(.*)([}\\]])$/);\n    return `${valMatch[1]}<span class=\"val-inner\">${valMatch[2]}</span>${\n      valMatch[3]\n    }`;\n  }\n\n  createTagInnerMarkup() {\n    return `<a class=\"expander\" href=\"#\">${super.createTagInnerMarkup()}</a>`;\n  }\n\n  render() {\n    super.render();\n    this.el\n      .querySelector('.expander')\n      .addEventListener('click', evt => this.onKeyClick(evt));\n  }\n\n  get expanded() {\n    return this.el.classList.contains('expanded');\n  }\n\n  expand() {\n    // Open new panel\n    Panel.renderToEl(this.el, {data: this.val});\n    this.el.classList.add('expanded');\n  }\n\n  collapse() {\n    this.el\n      .querySelectorAll('.panel')\n      .forEach(e => e.parentNode.removeChild(e));\n    this.el.classList.remove('expanded');\n  }\n\n  onKeyClick(evt) {\n    if (this.expanded) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n\n    evt.stopPropagation();\n    evt.preventDefault();\n  }\n}\n\nexport default Pair.create;\n","import createPair from './pair';\n\nexport default class Panel {\n  constructor(options) {\n    this.options = options;\n  }\n\n  get selector() {\n    return this.options.selector;\n  }\n\n  get data() {\n    return this.options.data;\n  }\n\n  get valTransformer() {\n    return this.options.valTransformer;\n  }\n\n  isArray() {\n    return Array.isArray(this.data);\n  }\n\n  createListTag() {\n    if (this.isArray()) {\n      const ol = document.createElement('ol');\n      ol.className = 'list';\n      ol.start = 0;\n      return ol;\n    }\n\n    const ul = document.createElement('ul');\n    ul.className = 'list';\n    return ul;\n  }\n\n  createListItem(key, val) {\n    const pair = createPair(key, val, this.valTransformer);\n    pair.render();\n    return pair.el;\n  }\n\n  render() {\n    const list = this.createListTag();\n    Object.entries(this.data).forEach(([key, val]) => {\n      list.append(this.createListItem(key, val));\n    });\n\n    const listWrap = document.createElement('div');\n    listWrap.className = 'panel';\n    listWrap.append(list);\n    this.el = listWrap;\n    return this;\n  }\n\n  static renderToEl(container, options) {\n    const panel = new Panel(options);\n    panel.render();\n\n    container.append(panel.el);\n    return panel;\n  }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import Panel from './panel';\nimport {getObjectWithDefaults} from './util';\nimport './styles/jsonpanel-next.scss';\n\nconst defaultOptions = {\n  selector: '#jsonpanel',\n  data: {}\n};\n\nexport default function jsonpanelNext(options) {\n  options = getObjectWithDefaults(options, defaultOptions);\n  return Panel.renderToEl(\n    window.document.querySelector(options.selector),\n    options\n  );\n}\n"],"names":["getObjectWithDefaults","obj","defaultObj","const","newObj","JSON","parse","stringify","simpleClone","Object","assign","Pair","key","val","valTransformer","this","create","prototype","toString","call","isPlainObject","Array","isArray","ExpandablePair","SimplePair","getKeyMarkup","prototypeAccessors","valType","getValInnerMarkup","createTagInnerMarkup","class","createTag","li","document","createElement","className","innerHTML","render","el","prototypeAccessors$1","super","Function","prototypeAccessors$2","valMatch","match","querySelector","addEventListener","evt","onKeyClick","expanded","classList","contains","expand","Panel","renderToEl","data","add","collapse","querySelectorAll","forEach","e","parentNode","removeChild","remove","stopPropagation","preventDefault","options","selector","createListTag","ol","start","ul","createListItem","pair","createPair","list","entries","ref","append","listWrap","container","panel","css","insertAt","head","getElementsByTagName","style","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","defaultOptions","window"],"mappings":"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"}